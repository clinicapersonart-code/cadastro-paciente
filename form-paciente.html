<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cadastro de Paciente – Clínica Personart</title>
  <style>
    :root{
      --bg:#0b1220;
      --card:#111827;
      --muted:#e5e7eb;
      --text:#f8fafc;
      --brand:#F2C8A0;
      --brand-dark:#E3B189;
      --border:#374151;
      --danger:#ef4444;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial,"Noto Sans";
      background:linear-gradient(180deg,#0b1220 0%,#0f172a 100%);
      color:var(--text);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:16px;
    }
    .card{
      background:radial-gradient(900px 200px at 10% -10%,rgba(242,200,160,.16),transparent),
                 linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.01));
      border:1px solid var(--border);
      border-radius:18px;
      padding:18px 18px 20px;
      max-width:500px;
      width:100%;
      box-shadow:0 16px 50px rgba(0,0,0,.55);
    }
    h1{
      margin:0 0 4px;
      font-size:22px;
      color:var(--brand);
      letter-spacing:.3px;
    }
    .subtitle{
      margin:0 0 14px;
      font-size:13px;
      color:#cbd5e1;
    }
    label{
      display:block;
      font-size:13px;
      color:#e5e7eb;
      margin-bottom:4px;
    }
    input[type="text"],
    input[type="tel"],
    input[type="email"],
    input[type="date"],
    select,
    textarea{
      width:100%;
      background:#020617;
      color:var(--text);
      border:1px solid var(--border);
      border-radius:10px;
      padding:9px 10px;
      font-size:14px;
      outline:none;
    }
    textarea{min-height:80px; resize:vertical;}
    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .radio{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:5px 9px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#020617;
      font-size:13px;
      cursor:pointer;
    }
    .hint{
      font-size:11px;
      color:#9ca3af;
      margin-top:2px;
    }
    .lgpd-box{
      margin-top:10px;
      padding:8px;
      border-radius:10px;
      border:1px solid var(--border);
      background:#020617;
      font-size:12px;
      color:#d1d5db;
    }
    .lgpd-box strong{color:var(--brand);}
    .lgpd-check{
      display:flex;
      align-items:flex-start;
      gap:6px;
      margin-top:6px;
      font-size:12px;
    }
    .lgpd-check input{margin-top:2px;}
    .btn{
      appearance:none;
      border:0;
      border-radius:999px;
      padding:10px 16px;
      font-size:14px;
      font-weight:600;
      cursor:pointer;
    }
    .btn-primary{
      background:var(--brand);
      color:#111827;
      width:100%;
      margin-top:14px;
    }
    .btn-primary:disabled{
      opacity:.6;
      cursor:wait;
    }
    .status{
      margin-top:10px;
      font-size:13px;
      text-align:center;
    }
    .status.ok{color:#bbf7d0;}
    .status.err{color:#fecaca;}
    .small{
      font-size:11px;
      color:#9ca3af;
      margin-top:10px;
      text-align:center;
    }
  </style>
</head>
<body>
  <main class="card">
    <header>
      <h1>Cadastro de Paciente</h1>
      <p class="subtitle">Clínica Personart – preencha seus dados para entrarmos em contato.</p>
    </header>

    <form id="form-paciente">
      <div>
        <label for="nome">Nome completo *</label>
        <input id="nome" type="text" required placeholder="Ex.: Ana Silva" />
      </div>

      <div style="margin-top:10px">
        <label for="nascimento">Data de nascimento *</label>
        <input id="nascimento" type="date" required />
      </div>

      <div style="margin-top:8px">
        <label>Faixa etária *</label>
        <div class="row">
          <label class="radio">
            <input type="radio" name="faixa" value="Criança" id="faixa-crianca" required />
            Criança
          </label>
          <label class="radio">
            <input type="radio" name="faixa" value="Adulto" id="faixa-adulto" />
            Adulto
          </label>
        </div>
        <div class="hint">Se for criança, informe o responsável abaixo.</div>
      </div>

      <div id="responsavel-wrap" style="margin-top:10px; display:none;">
        <label for="responsavel">Nome do responsável</label>
        <input id="responsavel" type="text" placeholder="Ex.: Maria de Souza (mãe)" />
      </div>

      <div style="margin-top:10px">
        <label for="contato">Telefone / WhatsApp *</label>
        <input id="contato" type="tel" required placeholder="(15) 9 9999-9999" />
      </div>

      <div style="margin-top:10px">
        <label for="email">E-mail (opcional)</label>
        <input id="email" type="email" placeholder="voce@exemplo.com" />
      </div>

      <div style="margin-top:10px">
        <label for="convenio">Convênio *</label>
        <select id="convenio" required>
          <option value="">Selecione...</option>
          <option value="Particular">Particular</option>
          <option value="Funserv">Funserv</option>
          <option value="Danamed">Danamed</option>
          <option value="Gama Saúde">Gama Saúde</option>
          <option value="Fusex">Fusex</option>
          <option value="BlueSaúde">BlueSaúde</option>
          <option value="Unimed Campinas">Unimed Campinas</option>
          <option value="Ossel">Ossel</option>
          <option value="Ofebas">Ofebas</option>
          <option value="Outro">Outro</option>
        </select>
      </div>

      <div style="margin-top:10px">
        <label for="queixa">Motivo da procura / queixa principal *</label>
        <textarea id="queixa" required placeholder="Conte brevemente o motivo pelo qual busca atendimento."></textarea>
      </div>

      <div class="lgpd-box">
        <strong>LGPD – Uso dos seus dados</strong>
        <p style="margin:4px 0 0;">
          Os dados informados serão usados somente pela Clínica Personart para contato,
          agendamento e organização interna do atendimento, conforme a Lei Geral de Proteção
          de Dados (LGPD). Não compartilhamos suas informações com terceiros sem necessidade
          legal ou sua autorização.
        </p>
        <label class="lgpd-check">
          <input type="checkbox" id="lgpd" required />
          <span>Li e concordo com o uso dos meus dados pessoais conforme descrito acima.</span>
        </label>
      </div>

      <button class="btn btn-primary" type="submit" id="btn-enviar">Enviar cadastro</button>
    </form>

    <div id="status" class="status"></div>
    <div class="small">Desenvolvido para Clínica Personart.</div>
  </main>

  <script>
    // URL do seu Apps Script (já preenchida)
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxzJMIZBnlQaj1YSrP7Al585qoFrjm7jthbYvVo8eZkyGOrS6iPr6WVie4mqnCsJ-K_7A/exec";

    const $ = (s,r=document)=>r.querySelector(s);

    const faixaCrianca = $('#faixa-crianca');
    const faixaAdulto = $('#faixa-adulto');
    const responsavelWrap = $('#responsavel-wrap');

    function atualizarResponsavel(){
      if(faixaCrianca.checked){
        responsavelWrap.style.display = '';
      }else{
        responsavelWrap.style.display = 'none';
      }
    }
    faixaCrianca.addEventListener('change', atualizarResponsavel);
    faixaAdulto.addEventListener('change', atualizarResponsavel);

    document.getElementById('form-paciente').addEventListener('submit', async (e)=>{
      e.preventDefault();
      const btn = $('#btn-enviar');
      const status = $('#status');
      status.textContent = '';
      status.className = 'status';

      // validação básica extra
      const nome = $('#nome').value.trim();
      const nascimento = $('#nascimento').value;
      const contato = $('#contato').value.trim();
      const queixa = $('#queixa').value.trim();
      const convenio = $('#convenio').value;
      const lgpdOk = $('#lgpd').checked;
      const faixa = faixaCrianca.checked ? 'Criança' : (faixaAdulto.checked ? 'Adulto' : '');

      if(!nome || !nascimento || !contato || !queixa || !convenio || !faixa || !lgpdOk){
        status.textContent = 'Preencha todos os campos obrigatórios.';
        status.classList.add('err');
        return;
      }

      const payload = {
        origem: 'novo_cadastro_paciente',
        nome,
        nascimento,
        faixa,
        responsavel: $('#responsavel').value.trim(),
        contato,
        email: $('#email').value.trim(),
        convenio,
        queixa,
        ts: new Date().toISOString()
      };

      btn.disabled = true;
      btn.textContent = 'Enviando...';

      try{
        const res = await fetch(SCRIPT_URL, {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify({
            kind: 'novo_cadastro_paciente',
            data: payload
          })
        });

        if(!res.ok) throw new Error('Erro HTTP: '+res.status);

        status.textContent = 'Cadastro enviado com sucesso. Obrigado, em breve a equipe da Clínica Personart entrará em contato.';
        status.classList.add('ok');

        // limpa, mas mantém a sensação de "concluído"
        e.target.reset();
        atualizarResponsavel();
      }catch(err){
        status.textContent = 'Não foi possível enviar seu cadastro. Tente novamente mais tarde.';
        status.classList.add('err');
      }finally{
        btn.disabled = false;
        btn.textContent = 'Enviar cadastro';
      }
    });
  </script>
</body>
</html>
